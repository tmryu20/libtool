<html>
<!-- æ—¥æœ¬èªã¯ã©ã†ãªã‚‹ã® -->

<head>
  <title>Deep Link Encoder</title>
  <style>
    body {
      font-family: sans-serif;
      line-height: 1.6;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
      background-color: #f9f9f9;
      color: #333;
    }

    .container {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1,
    h2 {
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }

    h1 {
      color: #333;
    }

    h2 {
      color: #555;
    }

    textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 4px;
      border: 1px solid #ddd;
      box-sizing: border-box;
    }

    input[type="button"] {
      background-color: #007bff;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }

    input[type="button"]:hover {
      background-color: #0056b3;
    }

    .prefix-btn {
      background-color: #6c757d;
      color: white;
      padding: 5px 10px;
      margin-right: 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .prefix-btn:hover {
      background-color: #5a6268;
    }

    ul {
      list-style-type: disc;
      padding-left: 20px;
    }

    li {
      margin-bottom: 8px;
    }

    a {
      color: #007bff;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    code {
      background-color: #eee;
      padding: 2px 4px;
      border-radius: 4px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Deep Link Encoder</h1>
    <form name="fm">
      <textarea name="inptext" cols="80" rows="5" placeholder="URL ã¾ãŸã¯ Windows ãƒ‘ã‚¹ã‚’å…¥åŠ›"></textarea>
      <div id="prefix-buttons" style="margin-top: 5px; margin-bottom: 10px;">
        <input type="button" class="prefix-btn" value="Excel" onclick="setPrefix('ms-excel:ofe|u|')">
        <input type="button" class="prefix-btn" value="PowerPoint" onclick="setPrefix('ms-powerpoint:ofe|u|')">
        <input type="button" class="prefix-btn" value="Teams" onclick="setPrefix('msteams:')">
        <input type="button" class="prefix-btn" value="Explorer" onclick="setPrefix('file-explorer:')">
        <input type="button" class="prefix-btn" value="Antigravity" onclick="setLocalPathProtocol('antigravity')">
        <input type="button" class="prefix-btn" value="Cursor" onclick="setLocalPathProtocol('cursor')">
      </div>
      <textarea name="enctext" cols="80" rows="5" readonly placeholder="ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸURLãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"></textarea><br>
      <input type="button" value="Encode" onclick="generateLink()">
    </form>
    <div id="result-link-container" style="margin-top: 10px;"></div>
  </div>

  <div class="container" style="margin-top: 20px;">
    <h2>âœ… DLENC</h2>
    <ul>
      <li><a href="https://tmryu.netlify.app/dlenc.html">ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªãƒ³ã‚¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆç”Ÿæˆ</a></li>
    </ul>

    <h2>âœ… MSãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªèµ·å‹•</h2>
    <ul>
      <li><code>ms-excel:ofe|u|</code></li>
      <li><code>ms-powerpoint:ofe|u|</code></li>
      <li>Teamsï¼š<code>msteams: URL</code></li>
    </ul>

    <h2>âœ… box â†’ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ—ãƒªèµ·å‹•</h2>
    <ul>
      <li>BOX ã§ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚’é–‹ã</li>
      <li>Develperãƒ¢ãƒ¼ãƒ‰ã§ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§ã€<code>ms-</code> ã‚’æ¤œç´¢</li>
    </ul>

    <h2>âœ… Onedrive</h2>
    <ul>
      <li>å…±æœ‰ã‹ã‚‰ğŸ”—ã‚’ã‚³ãƒ”ãƒ¼</li>
      <li><code>ms-excelãƒ»ãƒ»ãƒ»</code>ã®å¾Œã«çµåˆã™ã‚‹</li>
    </ul>

    <h2>âœ… box</h2>
    <ul>
      <li>ãƒ‡ãƒãƒƒã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§<code>ms-excel</code>ã‚’æ¢ã™</li>
    </ul>

    <h2>âœ… ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã§é–‹ã</h2>
    <ul>
      <li><code>file-explorer:</code></li>
    </ul>

    <h2>âœ… Antigravity</h2>
    <ul>
      <li><code>antigravity://file/ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹</code></li>
    </ul>

    <h2>âœ… Cursor</h2>
    <ul>
      <li><code>cursor://file/ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹</code></li>
    </ul>
  </div>
  <script>
    function setPrefix(prefix) {
      const inptext = document.fm.inptext;
      let val = inptext.value;
      const prefixes = [
        'ms-excel:ofe|u|',
        'ms-powerpoint:ofe|u|',
        'msteams:',
        'file-explorer:',
        'antigravity://file/',
        'cursor://file/'
      ];

      for (const p of prefixes) {
        if (val.startsWith(p)) {
          val = val.substring(p.length);
          break;
        }
      }

      inptext.value = prefix + val;
      inptext.focus();
    }

    function setLocalPathProtocol(protocol) {
      const inptext = document.fm.inptext;
      let path = inptext.value.trim();
      const targetPrefix = protocol + '://file/';

      const prefixes = [
        'ms-excel:ofe|u|',
        'ms-powerpoint:ofe|u|',
        'msteams:',
        'file-explorer:',
        'antigravity://file/',
        'cursor://file/'
      ];

      for (const p of prefixes) {
        if (path.startsWith(p)) {
          path = path.substring(p.length);
          try {
            path = decodeURI(path);
          } catch (e) {
            console.error('Error decoding path:', e);
          }
          break;
        }
      }

      if (path === '') {
        inptext.value = targetPrefix;
      } else {
        path = path.replace(/\\/g, '/');
        // Encode the path to handle spaces and special characters
        const encodedPath = encodeURI(path);
        inptext.value = targetPrefix + encodedPath;
      }
      inptext.focus();
    }

    function generateLink() {
      const inputText = document.fm.inptext.value;
      const enctext = document.fm.enctext;
      const linkContainer = document.getElementById('result-link-container');

      if (inputText.trim() === '') {
        enctext.value = '';
        linkContainer.innerHTML = '';
        return;
      }

      const encodedUrl = 'https://tmryu.netlify.app/on.html?url=' + encodeURIComponent(inputText);
      enctext.value = encodedUrl;

      // Copy to clipboard
      enctext.select();
      document.execCommand('copy');

      linkContainer.innerHTML = ''; // Clear previous link

      const link = document.createElement('a');
      link.href = encodedUrl;
      link.textContent = 'ç”Ÿæˆã•ã‚ŒãŸãƒªãƒ³ã‚¯ã‚’ãƒ†ã‚¹ãƒˆ';
      link.target = '_blank';
      link.rel = 'noopener noreferrer';

      linkContainer.appendChild(link);
    }
  </script>
</body>

</html>